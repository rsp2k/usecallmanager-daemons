---
import { Icon } from 'astro-icon/components';

interface Props {
  currentPath: string;
}

interface NavigationItem {
  name: string;
  href: string;
  icon: string;
  external?: boolean;
}

const { currentPath } = Astro.props;

// Get docs URL from environment or use relative path for local development
const docsUrl = import.meta.env.PUBLIC_DOCS_URL || 'https://docs.usecallmanager-services.l.supported.systems';

const navigation: NavigationItem[] = [
  { name: 'Dashboard', href: '/', icon: 'lucide:layout-dashboard' },
  { name: 'Certificates', href: '/certificates', icon: 'lucide:shield-check' },
  { name: 'Devices', href: '/devices', icon: 'lucide:smartphone' },
  { name: 'Issuer Certificate', href: '/issuer-certificate', icon: 'lucide:award' },
  { name: 'Security Tools', href: '/security-tools', icon: 'lucide:lock' },
  { name: 'Documentation', href: docsUrl, icon: 'lucide:book-open', external: true },
];

function isActive(href: string): boolean {
  if (href === '/') {
    return currentPath === '/';
  }
  return currentPath.startsWith(href);
}
---

<aside class="flex w-64 flex-col border-r bg-card">
  <div class="flex h-16 items-center border-b px-6">
    <a href="/" class="flex items-center gap-2">
      <Icon name="lucide:shield" class="h-6 w-6 text-primary" />
      <span class="text-lg font-semibold">UseCallManager</span>
    </a>
  </div>
  <nav class="flex-1 space-y-1 p-4">
    {
      navigation.map((item) => (
        <a
          href={item.href}
          target={item.external ? '_blank' : undefined}
          rel={item.external ? 'noopener noreferrer' : undefined}
          class:list={[
            'flex items-center gap-3 rounded-lg px-3 py-2 text-sm font-medium transition-colors',
            isActive(item.href)
              ? 'bg-primary/10 text-primary'
              : 'text-muted-foreground hover:bg-muted hover:text-foreground',
          ]}
        >
          <Icon name={item.icon} class="h-5 w-5" />
          {item.name}
          {item.external && <Icon name="lucide:external-link" class="h-4 w-4 ml-auto opacity-50" />}
        </a>
      ))
    }
  </nav>
  <div class="border-t p-4">
    <div class="rounded-lg bg-muted/50 p-3">
      <p class="text-xs text-muted-foreground">
        TVS: Port 2445<br />
        CAPF: Port 3804
      </p>
    </div>
  </div>
</aside>
