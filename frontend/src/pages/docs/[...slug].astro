---
import { getCollection, getEntry } from 'astro:content';
import DocsLayout from '../../layouts/DocsLayout.astro';

// Get the slug from the URL (in SSR mode)
const slug = Astro.params.slug || 'index';

// Fetch the specific doc entry
const doc = await getEntry('docs', slug);

// Handle 404 if doc doesn't exist
if (!doc) {
  return Astro.redirect('/404');
}

const { Content } = await doc.render();
---

<DocsLayout title={doc.data.title} description={doc.data.description}>
  <div class="mb-8">
    <h1 class="text-4xl font-bold mb-2">{doc.data.title}</h1>
    <p class="text-lg text-muted-foreground">{doc.data.description}</p>
    {doc.data.lastUpdated && (
      <p class="text-sm text-muted-foreground mt-2">
        Last updated: {doc.data.lastUpdated.toLocaleDateString()}
      </p>
    )}
  </div>
  <Content />
</DocsLayout>
